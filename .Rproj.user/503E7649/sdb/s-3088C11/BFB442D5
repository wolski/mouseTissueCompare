{
    "contents" : "\n#'\n#'\n#'Selects those columns with same strain information\n#'\n#'@param all matrix starting wit columns named either Mito_ or Tissue_\n#'\n#'@export\n#'\nselectMatchStrains <- function(all){\n  rownames(all) = sub(\"^1\\\\/\",\"\",rownames(all))\n  tiss <- all[,grep(\"Tissue_\",colnames(all))]\n  colnames(tiss)<-gsub(\"Tissue_\",\"\", colnames(tiss))\n\n  mito <- all[,grep(\"Mito_\",colnames(all))]\n  colnames(mito)<-gsub(\"Mito_\",\"\", colnames(mito))\n\n  common<-intersect(colnames(tiss),colnames(mito))\n  tiss <- tiss[,colnames(tiss) %in% common]\n  mito <- mito[,colnames(mito) %in% common]\n  tiss <- tiss[,order(colnames(tiss))]\n  mito <- mito[,order(colnames(mito))]\n\n  stopifnot(colnames(tiss) == colnames(mito))\n\n  colnames(tiss)<- paste(\"Tissue_\",colnames(tiss),sep=\"\")\n  colnames(mito)<- paste(\"Mito_\",colnames(mito),sep=\"\")\n  all <- cbind(\"Tissue_\"=tiss, \"Mito_\"=mito)\n}\n\n#' filter ms exeperiment and aggreage peptides proteins\n#' @param exp - msexperiment\n#' @param scorethresh - threshold for mscore\n#' @param n - number of samples with mscore below scorethreshold\n#' @param TOPPeptidesPerProtein - number of peptides per protein to use for quantification\n#' @export\nfilterAndAggregate <- function(exp,scorethresh =0.005, n = 2,TOPPeptidesPerProtein=5){\n  exp = filterByScore(exp, scorethresh =scorethresh, n = n)\n  exp = aggregatePeptides(exp)\n  exp = orderByRT(exp)\n  # remove NA's\n  tmp = apply(exp$Intensity, 1, function(x){sum(is.na(x)) == 0 })\n  exp = subset( exp, tmp )\n  # select top 5 peptides\n  exp = selectTopPeptidesPerProtein(exp,peptop = TOPPeptidesPerProtein)\n  exp = aggregateProteins(exp)\n  return(exp$Intensity)\n}\n\n#' keep samples containing string\n#' @param tiss substring the sample must contain, it is colled tiss because it is the tissue name usually\n#' @param exp ms experiment\n#' @export\n#'\nkeepSample <- function(exp,tiss=\"Brain\"  ){\n  tmp <- colnames(exp$score)[!grepl(tiss, colnames(exp$score))]\n  exp <- removeSamples(exp,tmp)\n  return(exp)\n}\n\n#' load eperiment, aggregate peptides from top transitions etc.\n#'\n#' removes decoys\n#' keeps only proteotypic peptides\n#' @param SpecLib path to openswath output\n#' @param maxNRTransitions max transitions per peptide\n#' @param maxNRPeptides nr peptides per protein to keeps\n#' @export\n#'\nprefilterNewDataSet <- function(SpecLib, maxNRTransitions = 3, maxNRPeptides = 10){\n  obj = fread(SpecLib)\n  # number of transitions / peptide\n  nrt = maxNRTransitions\n  # nr of peptides per protein\n  peptop = maxNRPeptides\n\n  obj=prepareDF(obj)\n  colnames(obj)\n  msexpori = loadTransitonsMSExperiment(obj,nrt=nrt,peptop=peptop)\n  length(unique(msexpori$pepinfo$transition_group_id))\n  stopifnot(nrt==length(msexpori$pepinfo$transition_group_id) / length(unique(msexpori$pepinfo$transition_group_id)))\n  msexpori = removeDecoys(msexpori)\n  tmp = grep(\"^1\\\\/\",msexpori$pepinfo$ProteinName)\n  msexpori = subset(msexpori, tmp)\n  return(msexpori)\n}\n\n#' annotate sample\n#'\n#' @param msexpori msexperiment\n#' @param FileSampleMapping mapping of files to meaningfull label\n#' @param Samples2Remove sample to remove\n#' @export\n#'\nannotateSamples <- function(msexpori,FileSampleMapping,Samples2Remove=\"\"){\n  msexpori = removeSamples(msexpori, sample=Samples2Remove)\n  ncn = read.table(FileSampleMapping,header=T,stringsAsFactors = FALSE)\n  ncn = ncn[ ncn$Filename != Samples2Remove, ]\n  ncnOrdering <- match(colnames(msexpori$Intensity),ncn$Filename )\n  stopifnot(ncn$Filename[ncnOrdering] == colnames(msexpori$Intensity))\n  msexpori = mycolnames(msexpori,ncn[ncnOrdering,1])\n  return(msexpori)\n}\n\n\n",
    "created" : 1450784324503.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2982350077",
    "id" : "BFB442D5",
    "lastKnownWriteTime" : 1450811137,
    "path" : "C:/Users/wewol/prog/mouseTissueCompare/R/hello.R",
    "project_path" : "R/hello.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}